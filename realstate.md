# Laravel 10 - Build Real Estate Property Listing Project A-Z
Kazi Ariyan

# Estructura para Laravel Real Estate

## Sección 3 - Multi Auth with Breeze
- 08. Instalar Laravel 10
- 09. Create Database
- 10. Install Laravel Breeze
- 11. Seed Demo User Part 1
- 12. Seed Demo User Part 2
- 13. Multi Auth Breeze Part 1
- 14. Multi Auth Breeze Part 2
- 15. Multi Auth Breeze Part 3
- 16. Login With Name Email or Phone

## Sección 4 - Project Admin Panel Setup
- 17. Project Theme Overview
- 18. Admin Template Setup
- 19. Dashboard Page Segmentation
- 20. Admin Logout Option
- 21. Customize Login Form
- 22. Refresh Admin Template
- 23. Update Admin Assets Path
- 24. Admin Profile & Image Update Part 1
- 25. Admin Profile & Image Update Part 2
- 26. Admin Profile & Image Update Part 3
- 27. Admin Profile & Image Update Part 4
- 28. Adding Toaster In For View Message
- 29. Admin Profile Change Password Part 1
- 30. Admin Profile Change Password Part 2
- 31. Take Backup And Restore in Localhost

## Sección 5 - Project Frontend Template Setup
- 32. Frontend Template Setup Part 1
- 33. Frontend Template Setup Part 2
- 34. Frontend Template Setup Part 3
- 35. Frontend Template Login Page Setup
- 36. Frontend Template Register Page Setup

## Sección 6 - Project Frontend User Profile Setup
- 37. User Profile Design Part 1
- 38. User Profile Design Part 2
- 39. User Profile Design Part 3
- 40. User Logout Option
- 41. User Profile Password Change
- 42. Update User Login Setup with and without Login
- 43. User Login and Logout Notification

## Sección 7 - Project Backend Property Type Setup
- 44. Property Type Crud Part 1
- 45. Property Type Crud Part 2
- 46. Property Type Crud Part 3
- 47. Property Type Crud Part 4
- 48. Property Type Crud Part 5

## Sección 8 - Project Backend Property Amenities
- 49. Amenities Crud Part 1
- 50. Add Validation Message
- 51. Amenities Crud Part 2

## Sección 9 - Backend Add Property Page Design
- 52. Add Property Database Design Part 1 
- 53. Add Property Database Design Part 2
- 54. Add Property Database and Page Design Part 1
- 55. Add Property Database and Page Design Part 2
- 56. Show Image Using Javascript
- 57. Add Property Database and Page Design Part 5
- 58. Add Property Database and Page Design Part 6
- 59. Add Property Database and Page Design Part 7
- 60. Add Property Database and Page Design Part 8
- 61. Add Property JavaScript Validation

## Sección 10 - Backend Insert Property Setup 
- 62. Install Image Intervention Package
- 63. Property Insert Database Part 1
- 64. Property Insert Database Part 2
- 65. Property Insert Database Part 3
- 66. Property Insert Database Part 4
- 67. Manage Property Read All Product
- 68. Manage Property Edit Option Part 1
- 69. Manage Property Edit Option Part 2
- 70. Manage Property Update Option
- 71. Manage Property Update Single and Multiple Image Part 1
- 72. Manage Property Update Single and Multiple Image Part 2
- 73. Manage Property Update Single and Multiple Image Part 3
- 74. Manage Property Update Single and Multiple Image Part 4
- 75. Multiple Image Delete
- 76. Add Multi Image In Property
- 77. Manage Property Update Facility Part 1
- 78. Manage Property Update Facility Part 2
- 79. Property Delete With Multiple Image
- 80. Create Property Details Page Part 1
- 81. Create Property Details Page Part 2
- 82. Property Active Inactive From Details Page
- 83. Bug Fixed for Redirect Login Page

## Sección 11 - Add Agent Register Page Setup
- 84. Add Agent Register Page Setup Part 1
- 85. Add Agent Register Page Setup Part 2

## Sección 12 - Project Agent Panel Setup
- 86. Agent Template Setup
- 87. Agent Logout Option
- 88. Agent Profile & Image Update
- 89. Agent Profile Change Password

## Sección 13 - Manage Agent In Admin Dashboard
- 90. Manage Agent In admin Page Part 1 
- 91. Manage Agent In admin Page Part 2
- 92. Manage Agent In admin Page Part 3
- 93. Active Inactive In Agent Dashboard
- 94. Active Inactive Agent From Admin Page

## Sección 14 - Backend Add Property From Agent
- 95. Add Property From Agent Part 1
- 96. Add Property From Agent Part 2
- 97. Add Property From Agent Part 3
- 98. Add Property From Agent Part 4
- 99. Add Property From Agent Part 5
- 100. Update Add Property Amenities Fields

## Sección 15 - Backend Agent Buy Packages Option
- 101. Design Buy Package Agent Dashboard
- 102. Agent Buy Package Option Part 1
- 103. Agent Buy Package Option Part 2
- 104. Agent Buy Package Option Part 3
- 105. Agent Buy Package Option Part 4
- 106. Agent Buy Package Option Part 5

## Sección 16 - Package Sales Report In Agent Dashboard With PDF
- 107. Package sales Report In Agent Dashboard Part 1
- 108. Package sales Report In Agent Dashboard Part 2
- 109. Package sales Report In Agent Dashboard Part 3 

## Sección 17 - Package Sales Report In Admin Dashboard With PDF
- 110. Package Sales Report In Admin Dashboard Part 1
- 111. Package Sales Report In Admin Dashboard Part 2

## Sección 18 - Display Property Type In Frontend
- 112. Show Property Type In Frontend Part 1
- 113. Show Property Type In Frontend Part 2

## Sección 19 - Display Features Property In Frontend 
- 114. Show Features Property In Frontend Part 1
- 115. Show Features Property In Frontend Part 2

## Sección 20 - Setup Property Details Page 
- 116. Setup Property Details Page Part 1
- 117. Setup Property Details Page Part 2
- 118. Setup Property Details Page Part 3
- 119. Setup Property Details Page Part 4
- 120. Setup Property Details Page Part 5
- 121. Setup Property Details Related Page

## Sección 21 - Setup Property Wishlist Option
- 122. Property Wishlist Setup Part 1
- 123. Property Wishlist Setup Part 2
- 124. Property Wishlist Setup Part 3
- 125. Property Wishlist Setup Part 4
- 126. Property Wishlist Setup Part 5
- 127. Property Wishlist Setup Part 6
- 128. Property Wishlist Setup Part 7

## Sección 22 - Setup Property Compare Option 
- 129. Property Compare Setup Part 1
- 130. Property Compare Setup Part 2
- 131. Property Compare Setup Part 3
- 132. Property Compare Setup Part 4

## Sección 23 - Setup Send Message From Details Page
- 133. Send Message To agent Part 1
- 134. Send Message To agent Part 2
- 135. Send Message To agent Part 3

## Sección 24 - Setup Property Message In Agent Dashboard 
- 136. Send Message To Agent Part 1
- 137. Send Message To Agent Part 2
- 138. Send Message To Agent Part 3
- 139. Show Message In Admin Dashboard

## Sección 25 - Property Agent Page In Frontend
- 140. Display Agent Page in Frontend
- 141. Display Agent Details Page Part 1
- 142. Display Agent Details Page Part 2
- 143. Display Agent Details Page Part 3
- 144. Display Agent Details Page Part 4

## Sección 26 - Setup Property Buy and Rent List Page
- 145. Property Rent List Part 1
- 146. Property Rent List Part 2
- 147. Property Buy List
- 148. Get Type Wise Property
- 149. Update Header Menu

## Sección 27 - Create Custom Pagination 
- 150. Add Custom Pagination Part 1
- 151. Add Custom Pagination Part 2

## Sección 28 - Display Hot Latest Property In Frontend 
- 152. Show Hot Property in Frontend

## Sección 29 - Work For Property Location By State In Admin 
- 153. Property Location By State in Admin Part 1
- 154. Property Location By State in Admin Part 2
- 155. Property Location By State in Admin Part 3
- 156. Property Location By State in Admin Part 4
- 157. Update Admin Add and Edit Property for State Part 1
- 158. Update Admin Add and Edit Property for State Part 2
- 159. Update Agent Add and Edit Property for State

## Sección 30 - Property Location Area In Frontend
- 160. Property Location Area in Frontend Part 1
- 161. Property Location Area in Frontend Part 2
- 162. Property Location Area in Frontend Part 3

## Sección 31 - Property Search Option In Home Page 
- 163. Property Search Option in Home Page Part 1
- 164. Property Search Option in Home Page Part 2
- 165. Property Search Option in Home Page Part 3

## Sección 32 - Property Search Option In Category Page
- 166. Property Search Option in Category Page

## Sección 33 - Setup Testimonials From Admin Backend
- 167. Setup Testimonials from Admin Part 1
- 168. Setup Testimonials from Admin Part 2
- 169. Setup Testimonials from Admin Part 3
- 170. Setup Testimonials in Frontend

## Sección 34 - Admin Blog Category Setup
- 171. Advance Blog Category Setup Part 1
- 172. Advance Blog Category Setup Part 2
- 173. Advance Blog Category Setup Part 3
- 174. Advance Blog Category Setup Part 4

## Sección 35 - Admin Blog Management Setup
- 175. Blog Post Setup Part 1
- 176. Blog Post Setup Part 2
- 177. Blog Post Setup Part 3
- 178. Blog Post Setup Part 4

## Sección 36 - Show Blog In Front Page
- 179. Show Blog in Frontend Page Part 1
- 180. Show Blog in Frontend Page Part 2
- 181. Show Blog in Frontend Page Part 3

## Sección 37 - Category Wise Blog List Page
- 182. Show Blog Category List Page
- 183. Show Blog List Page

## Sección 38 - Blog Comment Function Frontend Page
- 184. Show Blog Comment in Frontend Page Part 1
- 185. Show Blog Comment in Frontend Page Part 2

## Sección 39 - Blog Comment Function Backend With Replay
- 186. Comment Function Backend With Replay Part 1
- 187. Comment Function Backend With Replay Part 2
- 188. Comment Function Backend With Replay Part 3

## Sección 40 - Schedule a Tour Setup for Property
- 189. Property Schedule a Tour Setup Part 1
- 190. Property Schedule a Tour Setup Part 2

## Sección 41 - Schedule a Tour Setup In Admin With Email
- 191. Schedule a Tour in Admin With Email Part 1
- 192. Schedule a Tour in Admin With Email Part 2
- 193. Schedule a Tour in Admin With Email Part 3
- 194. Schedule a Tour in Admin With Email Part 4
- 195. Schedule a Tour in Admin With Email Part 5

## Sección 42 - Dynamic Email Configuration In Laravel Edit env
- 196. Dynamic Email Configuration Part 1
- 197. Dynamic Email Configuration Part 2
- 198. Dynamic Email Configuration Part 3

## Sección 43 - Property Schedule in User Dashboard
- 199. Schedule in User Dashboard Part 1
- 200. Schedule in User Dashboard Part 2

## Sección 44 - Site Setting Option Update
- 201. Site Setting Option Part 1
- 202. Site Setting Option Part 2
- 203. Site Setting Option Part 3
- 204. Update Custom Title

## Sección 45 - Setup User Permission
- 205. User Permission Introduction
- 206. Install Laravel Spatie Permission
- 207. Setup User Permission Part 1
- 208. Setup User Permission Part 2
- 209. Setup User Permission Part 3

## Sección 46 - Permission Import and Export From Excel File
- 210. Install Laravel Excel Package in Project
- 211. How to Import and Export Permission Part 1
- 212. How to Import and Export Permission Part 2
- 213. How to Import and Export Permission Part 3

## Sección 47 - Setup User Roles 
- 214. Setup User Roles Part 1
- 215. Setup User Roles Part 2
- 216. Add Roles in Permission Part 1
- 217. Add Roles in Permission Part 2
- 218. Add Roles in Permission Part 3
- 219. Add Roles in Permission Part 4
- 220. Add Roles in Permission Part 5
- 221. Add Roles in Permission Part 6
- 222. Edit Roles in Permission Part 1
- 223. Edit Roles in Permission Part 2
- 224. Delete Roles in Permission

## Sección 48 - Multi Admin For Store 
- 225. Multi Admin Setup Part 1
- 226. Multi Admin Setup Part 2
- 227. Multi Admin Setup Part 3
- 228. Multi Admin Setup Part 4

## Sección 49 - Add Role And Permission in Sidebar
- 229. Add Role and Permission for Admin User Part 1
- 230. Add Role and Permission for Admin User Part 2

## Sección 50 - Create 404 and 403 Page
- 231. How to Create 404 Page
- 232. How to Create 403 Page

## Sección 51 - Live Chat Application System For User and Agent
- 233. Live Chat Application Introduction
- 234. Live Chat Application Part 1
- 235. Live Chat Application Part 2
- 236. Live Chat Application Part 3
- 237. Live Chat Application Part 4
- 238. Live Chat Application Part 5
- 239. Live Chat Application In User Page Part 1
- 240. Live Chat Application In User Page Part 2
- 241. Live Chat Application In User Page Part 3
- 242. Live Chat Application In User Page Part 4
- 243. Live Chat Application In User Page Part 5
- 244. Live Chat Application In User Page Part 6
- 245. Live Chat Application In User Page Part 7
- 246. Update Date Format With Moment
- 247. Live Chat Application for Agent Part 1
- 248. Live Chat Application for Agent Part 2


***


# Contenido
***

# S1 Introduccion
## 01. Que contruiremos



# S3 - Multi Auth with Breeze
## 13. Laravel Multi Auth with Breeze Part 1
## 14. Laravel Multi Auth with Breeze Part 2
- Para ver la lista de routes:
php artisan r:l

- Controlador responsable de redirigir:
app/Http/Controllers/Auth/AuthenticatedSessionController.php

- El control de router esta en:
app/Providers/RouteServiceProvider.php

Entonces para poder redirigir al usuario a nuestras tres rutas posibles:
- user
- admin
- agent

Tenemos que trabajar en:
app/Http/Controllers/Auth/AuthenticatedSessionController.php

Los datos los tomamos del Login Request:
app/Http/Requests/Auth/LoginRequest.php

En app/Http/Controllers/Auth/AuthenticatedSessionController.php 
Entonces podemos agregar el codigo de comparacion de que rol tiene el usuario asi:
```php
$url = '';
if ($request->user()->role === 'admin') {
    $url = 'admin/dashboard';
}elseif($request->user()->role === 'agent'){
    $url = 'agent/dashboard';
}elseif($request->user()->role === 'user'){
    $url = '/dashboard';
}

return redirect()->intended($url);
```
Listo!
Hasta aqui la redireccion esta lista, ahora falta la proteccion de las rutas para que un 
rol de user no pueda entrar a los otros dos dashboards (admin y agent).
## 15. Laravel Multi Auth with Breeze Part 3
Para proteger las rutas, necesitamos usar el middleware que nos ofrece Laravel.
- php artisan make:middleware Role

Nos crea:
app/Http/Middleware/Role.php

Ahora registrar este middleware en app/Http/Kernel.php:
'role' => \App\Http\Middleware\Role::class,

Ahora trabajamos en nuestro middleware app/Http/Middleware/Role.php:
```php
public function handle(Request $request, Closure $next, $role): Response
{
    if ($request->user()->role !== $role) {
        return redirect('dashboard');
    }
    return $next($request);
}
```

Ahora para proteger las rutas aplicamos middleware de grupo en routes/web.php:
```php
// Admin group middleware
Route::middleware(['auth','role:admin'])->group(function(){
    Route::get('/admin/dashboard', [AdminController::class, 'AdminDashboard'])->name('admin.dashboard');
});

// Agent group middleware
Route::middleware(['auth','role:agent'])->group(function(){
    Route::get('/agent/dashboard', [AgentController::class, 'AgentDashboard'])->name('agent.dashboard');
});
```
Listo!
## 16. Login with Name or Emailor Phone
Cambiar el label del login page en resources/views/auth/login.blade.php:
```php
<!-- Email Address -->
<div>
    <x-input-label for="login" :value="__('Email/Name/Phone')" />
    <x-text-input id="login" class="block mt-1 w-full" type="text" name="login" :value="old('login')" required autofocus autocomplete="username" />
</div>
```

Ahora modificar el codigo en app/Http/Requests/Auth/LoginRequest.php:
```php
use App\Models\User;
use Illuminate\Support\Facades\Hash;

public function rules(): array
{
    return [
        'login' => ['required', 'string'],
        'password' => ['required', 'string'],
    ];
}

public function authenticate(): void
{
    $this->ensureIsNotRateLimited();

    $user = User::where('email', $this->login)
                ->orWhere('name', $this->login)
                ->orWhere('phone', $this->login)
                ->first();

    if( !$user || !Hash::check($this->password, $user->password) ){
        RateLimiter::hit($this->throttleKey());

        throw ValidationException::withMessages([
            'login' => trans('auth.failed'),
        ]);
    }

    Auth::login($user, $this->boolean('remember'));
    RateLimiter::clear($this->throttleKey());
}
```
Listo!
Ya podemos ingresas con nombre, email o phone

# S4 - Admin Panel Setup## 31. Take Backup And Restore in Localhost
Para hacer Backup de todo el proyecto:
Primero remover y limpiar cache de laravel asi:
- php artisan config:cache
- php artisan cache:clear
- php artisan view:clear
- php artisan optimize
## 17. Project Theme Overview
Descargar los recursos (bootstrap backend theme) en:
~/Sites/recursos/udemy/Laravel 10 - Build Real Estate Property Listing Project A-Z/Course+Excise+Files/Course Excise Files
## 18. Admin template Setup
Copiar todo el folder de assets:
/home/enrique/Sites/recursos/udemy/Laravel 10 - Build Real Estate Property Listing Project A-Z/Course+Excise+Files/Course Excise Files/Backend Theme/assets
a:
/home/enrique/Sites/realestate/public

Ahora copiar las carpetas pages y partials de:
/home/enrique/Sites/recursos/udemy/Laravel 10 - Build Real Estate Property Listing Project A-Z/Course+Excise+Files/Course Excise Files/Backend Theme/Main
a:
/home/enrique/Sites/realestate/public/backend

Copiar el dashboard.html de:
/home/enrique/Sites/recursos/udemy/Laravel 10 - Build Real Estate Property Listing Project A-Z/Course+Excise+Files/Course Excise Files/Backend Theme/Main
a:
resources/views/admin/admin_dashboard.blade.php

Actualizar los assets con:
{{asset('') }}

Para parcializar nuestro contenido creamos:
resources/views/admin/index.blade.php
```php
@extends('admin.admin_dashboard')
@section('admin')

    {{-- Contenido --}}
    <div class="page-content"> 
    	...
    </div>
    <!-- End Contenido -->

@endsection
```

En resources/views/admin/admin_dashboard.blade.php:
```php
<!DOCTYPE html>

<html lang="en">

<head> 
	...
</head>

<body>

	<div class="main-wrapper">
	
		<!-- partial:partials/_sidebar.html -->
	    <nav class="sidebar">
			...
		</nav>
	    <!-- partial -->
	
	    <div class="page-wrapper">
	    
			<!-- Header Top Bar partial:partials/_navbar.html -->
          	<nav class="navbar">    
				...
			</nav>

			{{-- Contenido --}}
	      	@yield('admin')

			<!-- partial:partials/_footer.html -->
	      	<footer>
	      		...
      		</footer>
	   		 
	     </div>
	</div>
	
    <!-- core:js -->
    <script src="{{ asset('../assets/vendors/core/core.js') }}"></script>
    <!-- endinject -->
    			
	...
	
</body>

</html>
```
## 19. Dashboard Page Segmentation
Secmentar las secciones, creando:

- resources/views/admin/body/header.blade.php
- resources/views/admin/body/sidebar.blade.php
- resources/views/admin/body/footer.blade.php

En resources/views/admin/admin_dashboard.blade.php
```php
<div class="main-wrapper">

  <!-- partial:partials/_sidebar.html -->
  @include('admin.body.sidebar')

  <div class="page-wrapper">

    <!-- Header Top Bar partial:partials/_navbar.html -->
    @include('admin.body.header')

    {{-- Contenido --}}
    @yield('admin')

    <!-- partial:partials/_footer.html -->
    @include('admin.body.footer')

  </div>

</div>
```
## 20. Admin Logout Option
En resources/views/admin/body/header.blade.php:
```php
 <li class="dropdown-item py-2">
     <a href="{{ route('admin.logout') }}" class="text-body ms-0">
         <i class="me-2 icon-md" data-feather="log-out"></i>
         <span>Log Out</span>
     </a>
 </li>
```

En routes/web.php:
```php
Route::get('/admin/logout', [AdminController::class, 'AdminLogout'])->name('admin.logout');
```

En app/Http/Controllers/AdminController.php:
```php
use Illuminate\Support\Facades\Auth;
// Admin Logout
public function AdminLogout(Request $request){

    Auth::guard('web')->logout();
    $request->session()->invalidate();
    $request->session()->regenerateToken();
    return redirect('/login');

}
```
## 21. Customize Login Form
En routes/web.php:
Fuera del grupo de Admin group middleware
```php
Route::get('/admin/login', [AdminController::class, 'AdminLogin'])->name('admin.login');
```

En resources/views/admin/admin_login.blade.php:
```php
<head>
	...
	<title>Admin Login Page</title>

    <style type="text/css">
        .authlogin-side-wrapper{
            width: 100%;
            height: 100%;
            background-image: url({{ asset('upload/login.png') }});
        }
    </style>
	...
</head>

<body>
...
	{{-- Side Image --}}
    <div class="col-md-4 pe-md-0">
        <div class="authlogin-side-wrapper">

        </div>
    </div>

    {{-- Formulario de login --}}
    <div class="col-md-8 ps-md-0">
        <div class="auth-form-wrapper px-4 py-5">

            <a href="#"
                class="noble-ui-logo logo-light d-block mb-2">Fotos<span>Oficiales</span></a>
            <h5 class="text-muted fw-normal mb-4">Welcome back! Log in to your account.</h5>

            <form class="forms-sample" method="POST" action="{{ route('login') }}">
            @csrf

                {{-- Email/Name/Phone --}}
                <div class="mb-3">
                    <label for="login" class="form-label">Email/Name/Phone</label>
                    <input type="text" name="login" class="form-control" id="login"
                        placeholder="Email, Name, or Phone">
                </div>

                {{-- password --}}
                <div class="mb-3">
                    <label for="userPassword" class="form-label">Password</label>
                    <input type="password" class="form-control" id="password" name="password"
                        autocomplete="current-password" placeholder="Password">
                </div>

                {{-- Remember me --}}
                <div class="form-check mb-3">
                    <input type="checkbox" class="form-check-input" id="authCheck">
                    <label class="form-check-label" for="authCheck">
                        Remember me
                    </label>
                </div>

                {{-- botón login --}}
                <div>
                    <button type="submit" class="btn btn-outline-primary btn-icon-text mb-2 mb-md-0">
                        Login
                    </button>
                </div>

                {{-- Not a user? Sign up --}}
                <a href="register.html" class="d-block mt-3 text-muted">Not a user? Sign up</a>

            </form>

        </div>
    </div>
...
</body>
```
## 22. Refresh Admin Template
Dejar en el sidebar unos cuantos menus, en resources/views/admin/body/sidebar.blade.php:
```php
<li class="nav-item nav-category">Main</li>
<li class="nav-item">
    <a href="{{ route('admin.dashboard') }}" class="nav-link">
        <i class="link-icon" data-feather="box"></i>
        <span class="link-title">Dashboard</span>
    </a>
</li>

{{-- * WEB APPS --}}

{{-- * COMPONENTS --}}

{{-- * DOCS --}}

```

Quitar algunas cosas del header resources/views/admin/body/header.blade.php:
```php
Quitar lo de los lenguajes
```

Dejar soloen resources/views/admin/index.blade.php:
```php
{{-- Row 2 --}}
<div class="row">
  {{-- Monthly sales --}} a  12 columnas

{{-- Row 3 --}}
<div class="row">
    {{-- Inbox --}}
  	{{-- Projects --}}
```
## 23. Update Admin Assets Path
Mover la carpeta de assets a public/backend/assets y modificar en resources/views/admin/admin_dashboard.blade.php:
```php
<link rel="stylesheet" href="{{ asset('backend/assets/vendors/core/core.css') }}">
y en todas las partes donde sea necesario!
```

Tambien modificar los paths en resources/views/admin/admin_login.blade.php:
```php
<link rel="stylesheet" href="{{ asset('../../../assets/vendors/core/core.css') }}">
a
<link rel="stylesheet" href="{{ asset('backend/assets/vendors/core/core.css') }}">
y en todas las partes donde sea necesario!
```

Volver a cargar la pagina y par alimpiar el cache correr:
- php artisan optimize
## 24. Admin Profile & Image Update Part 1
Agregar la ruta a resources/views/admin/body/header.blade.php:
```php
<li class="dropdown-item py-2">
    <a href="{{ route('admin.profile') }}" class="text-body ms-0">
        <i class="me-2 icon-md" data-feather="user"></i>
        <span>Profile</span>
    </a>
</li>
```
En routes/web.php:
```php
Route::get('/admin/profile', [AdminController::class, 'AdminProfile'])->name('admin.profile');
```
En app/Http/Controllers/AdminController.php:
```php
// Admin Profile
public function AdminProfile(){
    $id = Auth::user()->id;
    $profileData = User::find($id);
    return view('admin.admin_profile_view', compact('profileData'));
}
```
En resources/views/admin/admin_profile_view.blade.php:
```php
@extends('admin.admin_dashboard')
@section('admin')

@endsection
```
Si hacemos cambios de ruta en web.php y queremos checar los cambios, laravel nos
manda un error como este:
```Route [admin.profile] not defined.```
Para corregir esto correr:
```php artisan optimize```
Para limpiar el cache!
Listo!
## 25. Admin Profile & Image Update Part 2
Customizar la forma izquierda de desplegar datos de perfil.
En resources/views/admin/admin_profile_view.blade.php:
```php
<div class="card-body">
    <div class="d-flex align-items-center justify-content-between mb-2">

        {{-- Foto --}}
        <div>
            <img class="wd-100 rounded-circle" src="{{ (!empty($profileData->photo)) ? url('upload/admin_images/'.$profileData->photo) : url('upload/no_image.jpg') }}" alt="profile">
            <span class="h4 ms-3">{{ $profileData->username }}</span>
        </div>

    </div>

    <div class="mt-3">
        <label class="tx-11 fw-bolder mb-0 text-uppercase">Name:</label>
        <p class="text-muted">{{ $profileData->name }}</p>
    </div>
    <div class="mt-3">
        <label class="tx-11 fw-bolder mb-0 text-uppercase">Email:</label>
        <p class="text-muted">{{ $profileData->email }}</p>
    </div>
    <div class="mt-3">
        <label class="tx-11 fw-bolder mb-0 text-uppercase">Phone:</label>
        <p class="text-muted">{{ $profileData->phone }}</p>
    </div>
    <div class="mt-3">
        <label class="tx-11 fw-bolder mb-0 text-uppercase">Address:</label>
        <p class="text-muted">{{ $profileData->address }}</p>
    </div>
    <div class="mt-3 d-flex social-links">
        <a href="javascript:;" class="btn btn-icon border btn-xs me-2">
            <i data-feather="github"></i>
        </a>
        <a href="javascript:;" class="btn btn-icon border btn-xs me-2">
            <i data-feather="twitter"></i>
        </a>
        <a href="javascript:;" class="btn btn-icon border btn-xs me-2">
            <i data-feather="instagram"></i>
        </a>
    </div>
</div>
```
## 26. Admin Profile & Image Update Part 3
Vamos a trabajar en la forma de la derecha "UPDATE ADMIN PROFILE"
En resources/views/admin/admin_profile_view.blade.php:
```php
@extends('admin.admin_dashboard')
@section('admin')

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
</head>

{{-- Contenido del profile form html --}}
<div class="page-content">

    <div class="row profile-body">

        <!-- left wrapper - Datos actuales del perfil -->
        <div class="d-none d-md-block col-md-4 col-xl-4 left-wrapper">
            <div class="card rounded">
                <div class="card-body">
                    <div class="d-flex align-items-center justify-content-between mb-2">

                        {{-- Foto --}}
                        <div>
                            <img class="wd-100 rounded-circle" src="{{ (!empty($profileData->photo)) ? url('upload/admin_images/'.$profileData->photo) : url('upload/no_image.jpg') }}" alt="profile">
                            <span class="h4 ms-3">{{ $profileData->username }}</span>
                        </div>

                    </div>

                    <div class="mt-3">
                        <label class="tx-11 fw-bolder mb-0 text-uppercase">Name:</label>
                        <p class="text-muted">{{ $profileData->name }}</p>
                    </div>
                    <div class="mt-3">
                        <label class="tx-11 fw-bolder mb-0 text-uppercase">Email:</label>
                        <p class="text-muted">{{ $profileData->email }}</p>
                    </div>
                    <div class="mt-3">
                        <label class="tx-11 fw-bolder mb-0 text-uppercase">Phone:</label>
                        <p class="text-muted">{{ $profileData->phone }}</p>
                    </div>
                    <div class="mt-3">
                        <label class="tx-11 fw-bolder mb-0 text-uppercase">Address:</label>
                        <p class="text-muted">{{ $profileData->address }}</p>
                    </div>
                    <div class="mt-3 d-flex social-links">
                        <a href="javascript:;" class="btn btn-icon border btn-xs me-2">
                            <i data-feather="github"></i>
                        </a>
                        <a href="javascript:;" class="btn btn-icon border btn-xs me-2">
                            <i data-feather="twitter"></i>
                        </a>
                        <a href="javascript:;" class="btn btn-icon border btn-xs me-2">
                            <i data-feather="instagram"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- wrapper derecha datos para editar -->
        <div class="col-md-8 col-xl-8 middle-wrapper">
            <div class="row">

                <div class="card">
                    <div class="card-body">

                        <h6 class="card-title">Update Admin Profile</h6>

                        <form class="forms-sample">

                            {{-- username --}}
                            <div class="mb-3">
                                <label for="exampleInputUsername1" class="form-label">Username</label>
                                <input type="text" name="username" class="form-control" id="exampleInputUsername1" autocomplete="off" value="{{ $profileData->username }}">
                            </div>

                            {{-- Name --}}
                            <div class="mb-3">
                                <label for="exampleInputEmail1" class="form-label">Name</label>
                                <input type="text" name="name" class="form-control" id="exampleInputUsername1" autocomplete="off" value="{{ $profileData->name }}">
                            </div>

                            {{-- Email --}}
                            <div class="mb-3">
                                <label for="exampleInputEmail1" class="form-label">Email</label>
                                <input type="email" name="email" class="form-control" id="exampleInputUsername1" autocomplete="off" value="{{ $profileData->email }}">
                            </div>

                            {{-- Phone --}}
                            <div class="mb-3">
                                <label for="exampleInputEmail1" class="form-label">Phone</label>
                                <input type="text" name="phone" class="form-control" id="exampleInputUsername1" autocomplete="off" value="{{ $profileData->phone }}">
                            </div>

                            {{-- Address --}}
                            <div class="mb-3">
                                <label for="exampleInputEmail1" class="form-label">Address</label>
                                <input type="text" name="address" class="form-control" id="exampleInputUsername1" autocomplete="off" value="{{ $profileData->address }}">
                            </div>

                            {{-- Seleccionar Photo --}}
                            <div class="mb-3">
                                <label for="exampleInputEmail1" class="form-label">Photo</label>
                                <input type="file" class="form-control" name="photo" id="image">
                            </div>

                            {{-- Desplegar Photo --}}
                            <div class="mb-3">
                                <label for="exampleInputEmail1" class="form-label"></label>
                                <img id="showImage" class="wd-80 rounded-circle" src="{{ (!empty($profileData->photo)) ? url('upload/admin_images/'.$profileData->photo) : url('upload/no_image.jpg') }}" alt="profile">
                            </div>

                            <button type="submit" class="btn btn-primary me-2">Save Changes</button>

                        </form>

                    </div>
                </div>

            </div>
        </div>

    </div>

</div>

<script type="text/javascript">

    $(document).ready(function(){
        $('#image').change(function(e){
            var reader = new FileReader();
            reader.onload = function(e){
                $('#showImage').attr('src',e.target.result);
            }
            reader.readAsDataURL(e.target.files['0']);
        });
    });

</script>

@endsection
```
Usamos java script para poder actualizar la imagen de la photo, y su usamos JS tenemos que traernos
Jquery, el cual lo copiamos de w3 schools.
## 27. Admin Profile & Image Update Part 4
Agregar el mrtodo de post y la ruta a la forma en resources/views/admin/admin_profile_view.blade.php
```php
<form method="POST" action="{{ route('admin.profile.store') }}" class="forms-sample" enctype="multipart/form-data">
@csrf

    {{-- username --}}
    <div class="mb-3">
        <label for="exampleInputUsername1" class="form-label">Username</label>
        <input type="text" name="username" class="form-control" id="exampleInputUsername1" autocomplete="off" value="{{ $profileData->username }}">
    </div>

    {{-- Name --}}
    <div class="mb-3">
        <label for="exampleInputEmail1" class="form-label">Name</label>
        <input type="text" name="name" class="form-control" id="exampleInputUsername1" autocomplete="off" value="{{ $profileData->name }}">
    </div>

    {{-- Email --}}
    <div class="mb-3">
        <label for="exampleInputEmail1" class="form-label">Email</label>
        <input type="email" name="email" class="form-control" id="exampleInputUsername1" autocomplete="off" value="{{ $profileData->email }}">
    </div>

    {{-- Phone --}}
    <div class="mb-3">
        <label for="exampleInputEmail1" class="form-label">Phone</label>
        <input type="text" name="phone" class="form-control" id="exampleInputUsername1" autocomplete="off" value="{{ $profileData->phone }}">
    </div>

    {{-- Address --}}
    <div class="mb-3">
        <label for="exampleInputEmail1" class="form-label">Address</label>
        <input type="text" name="address" class="form-control" id="exampleInputUsername1" autocomplete="off" value="{{ $profileData->address }}">
    </div>

    {{-- Seleccionar Photo --}}
    <div class="mb-3">
        <label for="exampleInputEmail1" class="form-label">Photo</label>
        <input type="file" class="form-control" name="photo" id="image">
    </div>

    {{-- Desplegar Photo --}}
    <div class="mb-3">
        <label for="exampleInputEmail1" class="form-label"></label>
        <img id="showImage" class="wd-80 rounded-circle" src="{{ (!empty($profileData->photo)) ? url('upload/admin_images/'.$profileData->photo) : url('upload/no_image.jpg') }}" alt="profile">
    </div>

    <button type="submit" class="btn btn-primary me-2">Save Changes</button>

</form>
```

Crear la ruta en routes/web.php
```php
Route::post('/admin/profile/store', [AdminController::class, 'AdminProfileStore'])->name('admin.profile.store');
```

Crear el metodo "AdminProfileStore" en app/Http/Controllers/AdminController.php
```php
// Admin Profile Store
public function AdminProfileStore(Request $request){
    $id = Auth::user()->id;
    $data = User::find($id);

    $data->username = $request->username;
    $data->name = $request->name;
    $data->email = $request->email;
    $data->phone = $request->phone;
    $data->address = $request->address;

    if ($request->file('photo')) {
        $file = $request->file('photo');
        $filename = date('YmdHi').$file->getClientOriginalName();
        $file->move(public_path('upload/admin_images'), $filename);
        $data['photo'] = $filename; //Guardar a Base de Datos
    }

    $data->save();

    return redirect()->back();
}
```
Listo!
## 28. Adding Tostaer In For View Message
Agregar toaster cdn en resources/views/admin/admin_dashboard.blade.php:
```php
<head>
  	...
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.css" >
</head>

<body>
	...
	
	{{-- Toaster cdn --}}
	    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
	
	    {{-- Toaster script --}}
	    <script>
	        @if(Session::has('message'))
	            var type = "{{ Session::get('alert-type','info') }}"
	                switch(type){
	                case 'info':
	                toastr.info(" {{ Session::get('message') }} ");
	                break;
	
	                case 'success':
	                toastr.success(" {{ Session::get('message') }} ");
	                break;
	
	                case 'warning':
	                toastr.warning(" {{ Session::get('message') }} ");
	                break;
	
	                case 'error':
	                toastr.error(" {{ Session::get('message') }} ");
	                break;
	            }
	        @endif
	    </script>

</body>
```

Y en app/Http/Controllers/AdminController.php
```php
public function AdminProfileStore(Request $request){

    $id = Auth::user()->id;
    $data = User::find($id);

    $data->username = $request->username;
    $data->name = $request->name;
    $data->email = $request->email;
    $data->phone = $request->phone;
    $data->address = $request->address;

    if ($request->file('photo')) {
        $file = $request->file('photo');
        unlink(public_path('upload/admin_images/'.$data->photo)); // para borrar la imagen anterior
        $filename = date('YmdHi').$file->getClientOriginalName();
        $file->move(public_path('upload/admin_images'), $filename);
        $data['photo'] = $filename; //Guardar a Base de Datos
    }

    $data->save();

    $notification = array(
        'message' => 'Perfil de Admin Actualizado Correctamente',
        'alert-type' => 'success'
    );

    return redirect()->back()->with($notification);
}
```

Para actualizar los datos del profileDropdown menu en resources/views/admin/body/header.blade.php
```php
...
@php

    $id = Auth::user()->id;
    $profileData = App\Models\User::find($id);

@endphp

{{-- profileDropdown --}}
<li class="nav-item dropdown">

    {{-- Imagen de Perfil de Arriba Header --}}
    <a class="nav-link dropdown-toggle" href="#" id="profileDropdown" role="button"
        data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <img class="wd-30 ht-30 rounded-circle" src="{{ (!empty($profileData->photo)) ? url('upload/admin_images/'.$profileData->photo) : url('upload/no_image.jpg') }}" alt="profile">
    </a>

    <div class="dropdown-menu p-0" aria-labelledby="profileDropdown">

        <div class="d-flex flex-column align-items-center border-bottom px-5 py-3">
            {{-- Imagen de Perfil de Abajo Menu --}}
            <div class="mb-3">
                <img class="wd-80 ht-80 rounded-circle" src="{{ (!empty($profileData->photo)) ? url('upload/admin_images/'.$profileData->photo) : url('upload/no_image.jpg') }}" alt="">
            </div>
            {{-- nombre y correo --}}
            <div class="text-center">
                <p class="tx-16 fw-bolder">{{ $profileData->name }}</p>
                <p class="tx-12 text-muted">{{ $profileData->email }}</p>
            </div>
        </div>

        {{-- menus --}}
        <ul class="list-unstyled p-1">

            {{-- Profile --}}
            <li class="dropdown-item py-2">
                <a href="{{ route('admin.profile') }}" class="text-body ms-0">
                    <i class="me-2 icon-md" data-feather="user"></i>
                    <span>Profile</span>
                </a>
            </li>

			...
			
        </ul>

    </div>
</li>
```
Listo!
## 29. Admin Profile Change Password Part 1
resources/views/admin/admin_change_password.blade.php
```php
<form method="POST" action="{{ route('admin.profile.store') }}" class="forms-sample" enctype="multipart/form-data">
@csrf


    {{-- Old Password --}}
    <div class="mb-3">
        <label for="exampleInputEmail1" class="form-label">Contraseña Vieja</label>
        <input type="password" name="old_password" class="form-control @error('old_password') is-invalid @enderror" id="old_password" autocomplete="off">
        @error('old_password')
            <span class="text-danger">{{ $message }}</span>
        @enderror
    </div>

    {{-- New Password --}}
    <div class="mb-3">
        <label for="exampleInputEmail1" class="form-label">Contraseña Nueva</label>
        <input type="password" name="new_password" class="form-control @error('new_password') is-invalid @enderror" id="new_password" autocomplete="off">
        @error('new_password')
            <span class="text-danger">{{ $message }}</span>
        @enderror
    </div>

    {{-- Confirm Password --}}
    <div class="mb-3">
        <label for="exampleInputEmail1" class="form-label">Confirmar Contraseña Nueva</label>
        <input type="password" name="new_password_confirmation" class="form-control" id="new_password_confirmation" autocomplete="off">
    </div>

    <button type="submit" class="btn btn-primary me-2">Save Changes</button>

</form>
```
## 30. Admin Profile Change Password Part 2
Cambios en:
- resources/views/admin/admin_change_password.blade.php
- routes/web.php
- app/Http/Controllers/AdminController.php- 
Para los detalles ver este commit en GitHub.

admin
udemy12345
## 31. Take Backup And Restore in Localhost
Para hacer Backup de todo el proyecto:

1. Primero remover y limpiar cache de laravel asi:
- php artisan config:cache
- php artisan cache:clear
- php artisan view:clear
- php artisan optimize

2. Comprimir toda la carpeta:
-  ~/Sites/realestate
Right click en explorer y comprimir a ZIP, queda un archivo como de 70MB:
- realestate.zip
Ahora exportar la base de datos, exportarla con phpMyadmin
- Export
- Custom
- Tick ON (IF NOT EXIST - less efficient as indexes will be generated during table creation)
- Go
Listo!

Para restaurarlo:
- pasar estos dos archivos a un carpeta y:
- extraer el realestate.zip
- crear una nueva base de datos en phpMyadmin "laravelbackup" por ejemplo.
- importar base de datos de file realestate.sql con phpMyadmin
- ahora ir a la carpeta ~/Sites/realestate_backup/realestate y correr:
- composer update
- para conectarnos a nuestra nueva base de datos importada, modificar .env
```php
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=laravelbackup
DB_USERNAME=enrique
DB_PASSWORD=sousa1234
```
- Probar corriendo:
- php artisan serve
Listo!

# Sección 5 - Project Frontend Template Setup
## 32. Frontend Template Setup Part 1
Cargar un tema para el frontend para todo los usuarios.
Copiar el Frontend theme de:
~/Sites/recursos/udemy/Laravel 10 - Build Real Estate Property Listing Project A-Z/Course+Excise+Files/Course Excise Files/Frontend

Crear nuevo controlador
```php
php artisan make:controller UserController
```

Copiar los assets de: ~/Sites/recursos/udemy/Laravel 10 - Build Real Estate Property Listing Project A-Z/Course+Excise+Files/Course Excise Files/Frontend/assets
a: public/frontend/assets

y copiar el index a:
resources/views/frontend/frontend_dashboard.blade.php

Update loas accesos a css js e images, en resources/views/frontend/frontend_dashboard.blade.php:
usando: {{ asset('frontend/') }}
```php
...
<!-- Stylesheets -->
<link href="{{ asset('frontend/assets/css/font-awesome-all.css') }}" rel="stylesheet">
<link href="{{ asset('frontend/assets/css/flaticon.css') }}" rel="stylesheet">
<link href="{{ asset('frontend/assets/css/owl.css') }}" rel="stylesheet">
<link href="{{ asset('frontend/assets/css/bootstrap.css') }}" rel="stylesheet">
<link href="{{ asset('frontend/assets/css/jquery.fancybox.min.css') }}" rel="stylesheet">
<link href="{{ asset('frontend/assets/css/animate.css') }}" rel="stylesheet">
<link href="{{ asset('frontend/assets/css/jquery-ui.css') }}" rel="stylesheet">
<link href="{{ asset('frontend/assets/css/nice-select.css') }}" rel="stylesheet">
<link href="{{ asset('frontend/assets/css/color/theme-color.css') }}" id="jssDefault" rel="stylesheet">
<link href="{{ asset('frontend/assets/css/switcher-style.css') }}" rel="stylesheet">
<link href="{{ asset('frontend/assets/css/style.css') }}" rel="stylesheet">
<link href="{{ asset('frontend/assets/css/responsive.css') }}" rel="stylesheet">
...
<!-- jequery plugins -->
<script src="{{ asset('frontend/assets/js/jquery.js') }}"></script>
<script src="{{ asset('frontend/assets/js/popper.min.js') }}"></script>
<script src="{{ asset('frontend/assets/js/bootstrap.min.js') }}"></script>
<script src="{{ asset('frontend/assets/js/owl.js') }}"></script>
<script src="{{ asset('frontend/assets/js/wow.js') }}"></script>
<script src="{{ asset('frontend/assets/js/validation.js') }}"></script>
<script src="{{ asset('frontend/assets/js/jquery.fancybox.js') }}"></script>
<script src="{{ asset('frontend/assets/js/appear.js') }}"></script>
<script src="{{ asset('frontend/assets/js/scrollbar.js') }}"></script>
<script src="{{ asset('frontend/assets/js/isotope.js') }}"></script>
<script src="{{ asset('frontend/assets/js/jquery.nice-select.min.js') }}"></script>
<script src="{{ asset('frontend/assets/js/jQuery.style.switcher.min.js') }}"></script>
<script src="{{ asset('frontend/assets/js/jquery-ui.js') }}"></script>
<script src="{{ asset('frontend/assets/js/nav-tool.js') }}"></script> 
```

En routes/web.php
```php
// Home User Frontend All Route
Route::get('/', [UserController::class, 'index']); 
```

Y en app/Http/Controllers/UserController.php:
```php
public function index(){
    return view('frontend.frontend_dashboard');
} 
```
Antes de probar, No olvidar correr:
```php
php artisan optimize 
```
No funciono!

Ya funciono!
me estaba faltando el asset:
```php 
<!-- main-js -->
<script src="{{ asset('frontend/assets/js/script.js') }}"></script>
```

También actualice todos las {{ asset('frontend/) }} para todas las images de la pagina, que son como 50!
## 33. Frontend Template Setup Part 2
Segmentar en secciones.
En resources/views/frontend/frontend_dashboard.blade.php:
```php
<body>

    <div class="boxed_wrapper">

        <!-- preloader -->
        @include('frontend.home.preload')

        <!-- main header -->
        @include('frontend.home.header')

        <!-- Mobile Menu  -->
        @include('frontend.home.mobile_menu')


        {{-- Sección principal --}}
        @yield('main')

        <!-- main-footer -->
        @include('frontend.home.footer')


        <!--Scroll to top-->
        <button class="scroll-top scroll-to-target" data-target="html">
            <span class="fal fa-angle-up"></span>
        </button>

    </div>


    <!-- jequery plugins -->
    <script src="{{ asset('frontend/assets/js/jquery.js') }}"></script>
    <script src="{{ asset('frontend/assets/js/popper.min.js') }}"></script>
    <script src="{{ asset('frontend/assets/js/bootstrap.min.js') }}"></script>
    <script src="{{ asset('frontend/assets/js/owl.js') }}"></script>
    <script src="{{ asset('frontend/assets/js/wow.js') }}"></script>
    <script src="{{ asset('frontend/assets/js/validation.js') }}"></script>
    <script src="{{ asset('frontend/assets/js/jquery.fancybox.js') }}"></script>
    <script src="{{ asset('frontend/assets/js/appear.js') }}"></script>
    <script src="{{ asset('frontend/assets/js/scrollbar.js') }}"></script>
    <script src="{{ asset('frontend/assets/js/isotope.js') }}"></script>
    <script src="{{ asset('frontend/assets/js/jquery.nice-select.min.js') }}"></script>
    <script src="{{ asset('frontend/assets/js/jQuery.style.switcher.min.js') }}"></script>
    <script src="{{ asset('frontend/assets/js/jquery-ui.js') }}"></script>
    <script src="{{ asset('frontend/assets/js/nav-tool.js') }}"></script>

    <!-- main-js -->
    <script src="{{ asset('frontend/assets/js/script.js') }}"></script>

</body> 
```

En resources/views/frontend/index.blade.php
Ponemos en main content
```php
@extends('frontend.frontend_dashboard')

@section('main')
    ...
@endsection
```
## 34. Frontend Template Setup Part 3
Ahora seccionar el main content.
En resources/views/frontend/index.blade.php
```php
@extends('frontend.frontend_dashboard')

@section('main')

<!-- banner-section -->
@include('frontend.home.banner')

<!-- category-section -->
@include('frontend.home.category')

<!-- feature-section -->
@include('frontend.home.feature')

<!-- video-section -->
@include('frontend.home.video')

<!-- deals-section -->
@include('frontend.home.deals')

<!-- testimonial-section end -->
@include('frontend.home.testimonial')

<!-- choose us - section -->
@include('frontend.home.chooseus')

<!-- place-section -->
@include('frontend.home.place')

<!-- team-section -->
@include('frontend.home.team')

<!-- cta-section -->
@include('frontend.home.cta')

<!-- news-section -->
@include('frontend.home.news')


<!-- download-section -->
@include('frontend.home.download')

@endsection 
```
Listo!
## 35. Frontend Template Login Page Setup
Tomar como base la forma de singin de:
- ~/Sites/recursos/udemy/Laravel 10 - Build Real Estate Property Listing Project A-Z/Course+Excise+Files/Course Excise Files/Frontend/signin.html

En resources/views/auth/login.blade.php
Solo la parte del tab-1 iniciar sesión
```php
{{-- tab-1 Login --}}
<div class="tab active-tab" id="tab-1">
    <div class="inner-box">
        <h4>Inicia Sesión</h4>
        <form action="{{ route('login') }}" method="post" class="default-form">
        @csrf

            {{-- Nombre --}}
            <div class="form-group">
                <label>Nombre/Correo/Teléfono</label>
                <input type="text" name="login" id="login" required="">
            </div>

            {{-- Password --}}
            <div class="form-group">
                <label>Contraseña</label>
                <input type="password" name="password" id="password" required="">
            </div>

            {{-- boton Sign In --}}
            <div class="form-group message-btn">
                <button type="submit" class="theme-btn btn-one">Iniciar</button>
            </div>

        </form>
        <div class="othre-text">
            <p>Have not any account? <a href="signup.html">Register Now</a></p>
        </div>
    </div>
</div> 
```
## 36. Frontend Template Register Page Setup
En el tab-2 Registrarse resources/views/auth/login.blade.php
```php
{{-- tab-2 Regístrate --}}
<div class="tab" id="tab-2">
    <div class="inner-box">
        <h4>Registrarse</h4>

        <form action="{{ route('register') }}" method="POST" class="default-form">
            @csrf

            {{-- Nombre --}}
            <div class="form-group">
                <label>Nombre</label>
                <input type="text" name="name" id="name" required="">
            </div>

            {{-- Email --}}
            <div class="form-group">
                <label>Correo Electrónico</label>
                <input type="email" name="email" id="email" required="">
            </div>

            {{-- Password --}}
            <div class="form-group">
                <label>Contraseña</label>
                <input type="password" name="password" id="password" required="">
            </div>

            {{-- Confirm Password --}}
            <div class="form-group">
                <label>Confirma Contraseña</label>
                <input type="password" name="password_confirmation" id="password_confirmation" required="">
            </div>

            {{-- botón regístrate --}}
            <div class="form-group message-btn">
                <button type="submit" class="theme-btn btn-one">Regístrate</button>
            </div>

        </form>

        <div class="othre-text">
            <p>Have not any account? <a href="signup.html">Register Now</a></p>
        </div>

    </div>
</div> 
``` 

Para redirigir a la pagina de login cuando visiten http://realestate.test/register
Modificar el acceso en app/Http/Controllers/Auth/RegisteredUserController.php
En vez de apuntar a return view('auth.register'); que apunte a login page!
```php
public function create(): View
{
    return view('auth.login');
} 
```

# Sección 6 - Project Frontend User Profile Setup
## 37. User Profile Design Part 1
Setup Theme Page
Tomar:
~/Sites/recursos/udemy/Laravel 10 - Build Real Estate Property Listing Project A-Z/Course+Excise+Files/Course Excise Files/Frontend/my-profile.html

Y copiar solo estas tres secciones en resources/views/dashboard.blade.php:
```php
@extends('frontend.frontend_dashboard')
@section('main')


<!--Page Title-->
...
<!--End Page Title-->

<!-- sidebar-page-container --> 
...
<!-- sidebar-page-container -->

<!-- subscribe-section -->
...
<!-- subscribe-section end -->

@endsection
``` 
Las modificaciones las podemos ver en este commit en github
## 38. User Profile Design Part 2
Display User
Archivos que modifique:
- resources/views/dashboard.blade.php
- app/Http/Controllers/UserController.php
- resources/views/frontend/dashboard/edit_profile.blade.php
- routes/web.php
- resources/views/frontend/dashboard/dashboard_sidebar.blade.php
## 39. User Profile Design Part 3
Update User
Archivos que modifique:
- app/Http/Controllers/UserController.php
- resources/views/frontend/frontend_dashboard.blade.php
- resources/views/frontend/dashboard/edit_profile.blade.php
- resources/views/admin/admin_profile_view.blade.php
- routes/web.php

Nota:
En app/Http/Controllers/UserController.php
Para que no falle la linea:
unlink(public_path('upload/user_images/' . $data->photo)); // para borrar la imagen anterior
La primera vez tenemos que comentarla, para salvar por lo menos una imagen.
Ya que este salvada la primer imagen ya podemos des-comentarla.

Para arreglar este problema usar:
```php
// dd($data->photo); //regresa null si es la primera vez (si no hay foto)
if (!empty($data->photo)) {
    unlink(public_path('upload/user_images/' . $data->photo)); // para borrar la imagen anterior
}
```
## 40. User Logout Option
User Logout
- resources/views/frontend/dashboard/dashboard_sidebar.blade.php
- routes/web.php
- app/Http/Controllers/UserController.php
## 41. User Profile Password Change
Cambiar Contraseña
- resources/views/frontend/dashboard/dashboard_sidebar.blade.php
- routes/web.php
- app/Http/Controllers/UserController.php
- resources/views/frontend/dashboard/change_password.blade.php
## 42. Update User Login Setup with and without Login
En resources/views/frontend/home/header.blade.php
```php
@auth
    <div class="sign-box">
        <a href="{{ route('dashboard') }}"><i class="fas fa-user"></i>Panel</a>
        <a href="{{ route('user.logout') }}" class="pl-3"><i class="fas fa-user"></i>Cerrar Sesión</a>
    </div>
@else
    <div class="sign-box">
        <a href="{{ route('login') }}"><i class="fas fa-user"></i>Iniciar Sesión</a>
    </div>
@endauth 
```
Listo!
## 43. User Login and Logout Notification
Para el User Logout
En app/Http/Controllers/UserController.php
```php
// User Logout
public function UserLogout(Request $request)
{

    Auth::guard('web')->logout();
    $request->session()->invalidate();
    $request->session()->regenerateToken();

    $notification = array(
        'message' => 'Cierre de Sesión Exitosa',
        'alert-type' => 'success'
    );

    return redirect('/login')->with($notification);

} 
```
Para el Admin Logout
En app/Http/Controllers/AdminController.php
```php
// Admin Logout
public function AdminLogout(Request $request)
{

    Auth::guard('web')->logout();
    $request->session()->invalidate();
    $request->session()->regenerateToken();

    $notification = array(
        'message' => 'Cierre de Sesión Exitosa',
        'alert-type' => 'success'
    );

    return redirect('/admin/login')->with($notification);

} 
```
Y agregar el toaster drivers a resources/views/admin/admin_login.blade.php
```php
<head> 
...
{{-- Toaster cdn --}}
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.css">
</head> 
<body>
...
{{-- Toaster cdn --}}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

{{-- Toaster script --}}
<script>
    @if(Session::has('message'))
        var type = "{{ Session::get('alert-type','info') }}"
            switch(type){
            case 'info':
            toastr.info(" {{ Session::get('message') }} ");
            break;

            case 'success':
            toastr.success(" {{ Session::get('message') }} ");
            break;

            case 'warning':
            toastr.warning(" {{ Session::get('message') }} ");
            break;

            case 'error':
            toastr.error(" {{ Session::get('message') }} ");
            break;
        }
    @endif
</script>
</body>
``` 

Ahora para las notificaciones del login para todos los usuarios
desplegando su nombre!
En app/Http/Controllers/Auth/AuthenticatedSessionController.php
```php
public function store(LoginRequest $request): RedirectResponse
{
    $request->authenticate();

    // Para saber quien esta haciendo el login
    $id = Auth::user()->id;
    $adminData = User::find($id);
    $userName = $adminData->name;

    $request->session()->regenerate();

    $notification = array(
        'message' => 'Usuario '. $userName .' ha iniciado sesión con éxito',
        'alert-type' => 'info'
    );

    $url = '';
    if ($request->user()->role === 'admin') {
        $url = 'admin/dashboard';
    }elseif($request->user()->role === 'agent'){
        $url = 'agent/dashboard';
    }elseif($request->user()->role === 'user'){
        $url = '/dashboard';
    }

    return redirect()->intended($url)->with($notification);
} 
```
Listo!

# Sección 7 - Project Backend Property Type Setup
## 44. Property Type Crud Part 1
Crear un nuevo controlador
```php
php artisan make:controller Backend/PropertyTypeController 
```
Crear un modelo y una tabla de migración
```php
php artisan make:model PropertyType -m 
```
En app/Models/PropertyType.php
```php
<?php
namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class PropertyType extends Model
{
    use HasFactory;
    // Para que todos los campos sean fillables
    protected $guarded = [];
}
```
En database/migrations/2023_05_31_212917_create_property_types_table.php
```php
Schema::create('property_types', function (Blueprint $table) {
    $table->id();

    $table->string('type_name');
    $table->string('type_icon')->nullable();

    $table->timestamps();
}); 
```
Hacer la migración:
```php
php artisan migrate 
```
En app/Http/Controllers/Backend/PropertyTypeController.php
```php
use Illuminate\Support\Facades\Auth;
use App\Models\PropertyType;

class PropertyTypeController extends Controller
{
    // Tomar todos los datos de la tabla property_types
    public function AllType(){

        $types = PropertyType::latest()->get();

        return view('backend.type.all_type', compact('types'));
    }

}
```
En resources/views/backend/type/all_type.blade.php
```php
@extends('admin.admin_dashboard')
@section('admin')



@endsection 
```

Añadir otro grupo de rutas solo para admins
En routes/web.php
```php
// Admin group middleware
Route::middleware(['auth','role:admin'])->group(function(){

    // Property All Routes
    Route::controller(PropertyTypeController::class)->group(function(){

        Route::get('/all/type', 'AllType')->name('all.type');

    });

}); 
```
Listo!
## 45. Property Type Crud Part 2
- resources/views/backend/type/all_type.blade.php
- resources/views/admin/admin_dashboard.blade.php
## 46. Property Type Crud Part 3
- resources/views/backend/type/all_type.blade.php
- routes/web.php
- app/Http/Controllers/Backend/PropertyTypeController.php
- resources/views/backend/type/add_type.blade.php
## 47. Property Type Crud Part 4
Edit Update Type
- resources/views/backend/type/edit_type.blade.php
- app/Http/Controllers/Backend/PropertyTypeController.php - UpdateType()
- routes/web.php - ruta '/update/type'
## 48. Property Type Crud Part 5
Delete y aviso con Sweet Alert 2
- En resources/views/admin/admin_dashboard.blade.php
```php
{{-- Plugin for sweet alert 2 --}}
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<script src="{{ asset('backend/assets/js/code/code.js') }}"></script> 
```
- Crear public/backend/assets/js/code/code.js
```php
$(function () {
    $(document).on("click", "#delete", function (e) {
        e.preventDefault();
        var link = $(this).attr("href");

        Swal.fire({
            title: "Are you sure?",
            text: "Delete This Data?",
            icon: "warning",
            showCancelButton: true,
            confirmButtonColor: "#3085d6",
            cancelButtonColor: "#d33",
            confirmButtonText: "Yes, delete it!",
        }).then((result) => {
            if (result.isConfirmed) {
                window.location.href = link;
                Swal.fire("Deleted!", "Your file has been deleted.", "success");
            }
        });
    });
}); 
```
Y en resources/views/backend/type/all_type.blade.php usar el id="delete"
```php
<td>
    <a href="{{ route('edit.type',$item->id) }}" class="btn btn-inverse-warning">Editar</a>
    <a href="{{ route('delete.type',$item->id) }}" class="btn btn-inverse-danger" id="delete">Borrar</a>
</td>
```
Ahora ya podemos usar nuestro mensaje con sweet alert 2.
Para modificar los mensajes solo editarlos en public/backend/assets/js/code/code.js

En routes/web.php
```php
Route::get('/delete/type/{id}', 'DeleteType')->name('delete.type'); 
```

En app/Http/Controllers/Backend/PropertyTypeController.php
```php
// Delete Type
public function DeleteType($id){

    PropertyType::findOrFail($id)->delete();

    $notification = array(
        'message' => 'Property Type se elimino con éxito!',
        'alert-type' => 'success'
    );

    return redirect()->back()->with($notification);

} 
```
Listo!

# Sección 8 - Project Backend Property Amenities
## 49. Amenities Crud Part 1
Crear una nueva tabla y su modelo
```php
php artisan make:model Amenities -m 
```
Agregar un solo campo, en database/migrations/2023_06_01_151806_create_amenities_table.php
```php
$table->string('amenities_name'); 
```
En en modelo hacer fillable todos los campos, app/Models/Amenities.php
```php
protected $guarded = []; 
```
Hacer la migracion:
```php
php artisan migrate 
```
Varios archivos mas ver este commit en github
## 50. Add Validation Message con JS Crud Part 1
Ahora vamos hacer la validación del campo con Java Script
- Copiar validate.min.js a /home/enrique/Sites/realestate/public/backend/assets/js/code
Para soportar este nuevo código tenemos que agregarlo a resources/views/admin/admin_dashboard.blade.php:
```php
{{-- Plugin para hacer validación de campos con JS --}}
<script src="{{ asset('backend/assets/js/code/validate.min.js') }}"></script> 
```
Y agregar este código JS en la pagina donde vamos a usar la validación, en este caso en resources/views/backend/amenities/add_amenities.blade.php, insertarlo antes de que termine la sección:
```php
<script type="text/javascript">
    $(document).ready(function (){
        $('#myForm').validate({
            rules: {
                field_name: {
                    required : true,
                }, 
                
            },
            messages :{
                field_name: {
                    required : 'Please Enter FieldName',
                }, 
                 

            },
            errorElement : 'span', 
            errorPlacement: function (error,element) {
                error.addClass('invalid-feedback');
                element.closest('.form-group').append(error);
            },
            highlight : function(element, errorClass, validClass){
                $(element).addClass('is-invalid');
            },
            unhighlight : function(element, errorClass, validClass){
                $(element).removeClass('is-invalid');
            },
        });
    });
    
</script>

@endsection 
```
Asegurarnos de incluir también el código Jquery al inicio de la sección:
```php
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script> 
```
Para que podamos usar ejecutar el código JS.
Agregar el id="myForm" correspondiente a nuestra forma:
```php
<form id="myForm" method="POST" action="{{ route('store.type') }}" class="forms-sample">
@csrf 
```
La forma y el codigo js ya modificados queda asi:
```php
...
<form id="myForm" method="POST" action="{{ route('store.type') }}" class="forms-sample">
@csrf


    {{-- Type Name --}}
    <div class="form-group mb-3">
        <label for="amenities_name" class="form-label">Amenities Name</label>
        <input type="text" name="amenities_name" class="form-control">
    </div>

    <button type="submit" class="btn btn-primary me-2">Save Changes</button>

</form> 
...
<script type="text/javascript">
    $(document).ready(function (){
        $('#myForm').validate({

            rules: {

                amenities_name: {
                    required : true,
                },

            },
            messages :{
                amenities_name: {
                    required : 'Favor entrar nombre de amenities, campo requerido',
                },


            },
            errorElement : 'span',
            errorPlacement: function (error,element) {
                error.addClass('invalid-feedback');
                element.closest('.form-group').append(error);
            },
            highlight : function(element, errorClass, validClass){
                $(element).addClass('is-invalid');
            },
            unhighlight : function(element, errorClass, validClass){
                $(element).removeClass('is-invalid');
            },
        });
    });

</script>
```
La ventaja que tenemos al usar la validación con JS es que sin tener que recargar la pagina
los errores de validación son desplegados.
Listo!
## 51. Amenities Crud Part 2
Completar las acciones de:
- Añadir
- Editar
- Update
- y Borrar
- resources/views/backend/amenities/add_amenities.blade.php
- routes/web.php
- app/Http/Controllers/Backend/PropertyTypeController.php

# Sección 9 - Backend Add Property Page Design
# 52. Add Property Database Design Part 1 
Crear un controlador nuevo:
```php
php artisan make:controller Backend/PropertyController 
```
Crear una nueva tabla, esto se hace creando su modelo con migración:
```php
php artisan make:model Property -m 
```
En el modelo app/Models/Property.php:
```php
class Property extends Model
{
    use HasFactory;

    // Para que todos los campos sean fill-ables
    protected $guarded = [];

} 
```
Los campos que vamos a crear en la tabla database/migrations/2023_06_02_011542_create_properties_table.php
```php
public function up(): void
{
    Schema::create('properties', function (Blueprint $table) {
        $table->id();

        $table->string('ptype_id');
        $table->string('amenities_id');
        $table->string('property_name');
        $table->string('property_slug');
        $table->string('property_code');
        $table->string('property_status');
        $table->string('lowest_price')->nullable();
        $table->string('max_price')->nullable();
        $table->string('property_thambnail');
        $table->string('short_descp')->nullable();
        $table->text('long_descp')->nullable();
        $table->string('bedrooms')->nullable();
        $table->string('bathrooms')->nullable();
        $table->string('garage')->nullable();
        $table->string('garage_size')->nullable();
        $table->string('property_size')->nullable();
        $table->string('property_video')->nullable();
        $table->string('address')->nullable();
        $table->string('city')->nullable();
        $table->string('state')->nullable();
        $table->string('postal_code')->nullable();
        $table->string('neighborhood')->nullable();
        $table->string('latitude')->nullable();
        $table->string('longitude')->nullable();
        $table->string('featured')->nullable();
        $table->string('hot')->nullable();
        $table->integer('agent_id')->nullable();
        $table->string('status')->default(0);

        $table->timestamps();
    });
} 
```
Listo!
# 53. Add Property Database Design Part 2
Crear una nueva tabla para almacenar las multiples imágenes asociadas a una propiedad.
```php
php artisan make:model MultiImage -m 
```
En app/Models/MultiImage.php
```php
// Para que todos los campos sean fill-ables
protected $guarded = []; 
```
Y en la tabla database/migrations/2023_06_02_013822_create_multi_images_table.php
```php
public function up(): void
{
    Schema::create('multi_images', function (Blueprint $table) {
        $table->id();

        $table->integer('property_id');
        $table->string('photo_name');

        $table->timestamps();
    });
} 
```
Crear otra tabla para los lugares cercanos (neighborhood).
```php
php artisan make:model Facility -m
```
Los campos en esta tabla database/migrations/2023_06_02_014659_create_facilities_table.php
```php
public function up(): void
{
    Schema::create('facilities', function (Blueprint $table) {
        $table->id();

        $table->integer('property_id');
        $table->string('facility_name')->nullable();
        $table->string('distance')->nullable();

        $table->timestamps();
    });
} 
```

Finalmente hacer las migraciones:
```php
php artisan migrate 
```
Se crearon las tres tablas con éxito:
```php
2023_06_02_011542_create_properties_table ....................... 89ms DONE
2023_06_02_013822_create_multi_images_table ..................... 24ms DONE
2023_06_02_014659_create_facilities_table ....................... 30ms DONE 
```
Listo!
# 54. Add Property Database and Page Design Part 1
Añadir otra opción de menu en el sidebar 
en resources/views/admin/body/sidebar.blade.php
```php
{{-- Property --}}
<a class="nav-link" data-bs-toggle="collapse" href="#property" role="button" aria-expanded="false"
    aria-controls="emails">
    <i class="link-icon" data-feather="mail"></i>
    <span class="link-title">Propiedades</span>
    <i class="link-arrow" data-feather="chevron-down"></i>
</a>
<div class="collapse" id="property">
    <ul class="nav sub-menu">
        <li class="nav-item">
            <a href="{{ route('all.property') }}" class="nav-link">Todas las Propiedades</a>
        </li>
        <li class="nav-item">
            <a href="{{ route('add.amenities') }}" class="nav-link">Añadir una Comodidad</a>
        </li>
    </ul>
</div> 
```
Crear su ruta en web.php
```php
// Admin group middleware
Route::middleware(['auth','role:admin'])->group(function(){
    ...
    // Property All Routes
    Route::controller(PropertyController::class)->group(function(){
        Route::get('/all/property', 'AllProperty')->name('all.property');
    });

}); 
```
En el controlador app/Http/Controllers/Backend/PropertyController.php
```php
// All Property / Todas las Propiedades
public function AllProperty(){

    // Recuperar todos los datos de la tabla properties
    $property = Property::latest()->get();
    return view('backend.property.all_property', compact('property'));
} 
```
Crear la vista donde presentaremos los datos en una tabla resources/views/backend/property/all_property.blade.php
Listo!
# 55. Add Property Database and Page Design Part 2
Diseño de la forma de captura de datos en resources/views/backend/property/add_property.blade.php
```php
Nos quedamos hasta aqui:
{{-- picture thumbnail --}}
<div class="col-sm-6">
    <div class="mb-3">
        <label class="form-label">Imagen Miniatura</label>
        <input type="file" name="lowest_price" class="form-control">
    </div>
</div><!-- Col -->

{{-- Multiple Image --}}
<div class="col-sm-6">
    <div class="mb-3">
        <label class="form-label">Imágenes Multiples</label>
        <input type="file" name="lowest_price" class="form-control">
    </div>
</div><!-- Col --> 
```
En la siguiente lección implementaremos la selección de la imágenes!
Listo!
# 56. Show Image Using Javascript
Usar los scrips de JS para visualizar tanto single image como multiple images.
en resources/views/backend/property/add_property.blade.php
```php
...
{{-- picture thumbnail --}}
<div class="col-sm-6">
    <div class="mb-3">
        <label class="form-label">Imagen Miniatura</label>
        <input type="file" name="property_thambnail" class="form-control" onChange="mainThamUrl(this)"  >
        <img src="" id="mainThmb">
    </div>
</div><!-- Col -->

{{-- Multiple Image --}}
<div class="col-sm-6">
    <div class="mb-3">
        <label class="form-label">Imágenes Multiples</label>
        <input type="file" name="multi_img[]" class="form-control" id="multiImg" multiple="">
        <div class="row" id="preview_img"> </div>
    </div>
</div><!-- Col --> 
...
{{-- Script de JS para visualizar la imagen --}}
<script type="text/javascript">
    function mainThamUrl(input){
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function(e){
              $('#mainThmb').attr('src',e.target.result).width(80).height(80);
            };
            reader.readAsDataURL(input.files[0]);
        }
    }
</script>

{{-- Script de JS para visualizar multiples imágenes --}}
<script type="text/javascript">

    $(document).ready(function(){
        $('#multiImg').on('change', function(){ //on file input change
        if (window.File && window.FileReader && window.FileList && window.Blob) //check File API supported browser
        {
            var data = $(this)[0].files; //this file data

            $.each(data, function(index, file){ //loop though each file
                if(/(\.|\/)(gif|jpe?g|png|webp)$/i.test(file.type)){ //check supported file type
                    var fRead = new FileReader(); //new filereader
                    fRead.onload = (function(file){ //trigger function on successful read
                    return function(e) {
                        var img = $('<img/>').addClass('thumb').attr('src', e.target.result) .width(100)
                    .height(80); //create image element
                        $('#preview_img').append(img); //append image to output element
                    };
                    })(file);
                    fRead.readAsDataURL(file); //URL representing the file's data.
                }
            });

        }else{
            alert("Your browser doesn't support File API!"); //if File API is absent
        }
        });
    });

</script>
```
Listo!
# 57. Add Property Database and Page Design Part 5
Seguir diseñando la forma en resources/views/backend/property/add_property.blade.php
```php
<form>

    {{-- Row 1 --}}
    <div class="row">

        {{-- Nombre Propiedad --}}
        <div class="col-sm-6">
            <div class="mb-3">
                <label class="form-label">Nombre</label>
                <input type="text" name="property_name" class="form-control">
            </div>
        </div><!-- Col -->

        {{-- Property Status --}}
        <div class="col-sm-6">
            <div class="mb-3">
                <label class="form-label">Estatus</label>
                <select name="property_status" class="form-select"
                    id="exampleFormControlSelect1">
                    <option selected="" disabled="">Seleccionar Estatus</option>
                    <option value="rent">Para Renta</option>
                    <option value="buy">Para Compra</option>
                </select>
            </div>
        </div><!-- Col -->

        {{-- Lowest Price --}}
        <div class="col-sm-6">
            <div class="mb-3">
                <label class="form-label">Precio mas Bajo</label>
                <input type="text" name="lowest_price" class="form-control">
            </div>
        </div><!-- Col -->

        {{-- Max Price --}}
        <div class="col-sm-6">
            <div class="mb-3">
                <label class="form-label">Precio mas Alto</label>
                <input type="text" name="max_price" class="form-control">
            </div>
        </div><!-- Col -->

        {{-- picture thumbnail --}}
        <div class="col-sm-6">
            <div class="mb-3">
                <label class="form-label">Imagen Miniatura</label>
                <input type="file" name="property_thambnail" class="form-control"
                    onChange="mainThamUrl(this)">
                <img src="" id="mainThmb">
            </div>
        </div><!-- Col -->

        {{-- Multiple Image --}}
        <div class="col-sm-6">
            <div class="mb-3">
                <label class="form-label">Imágenes Multiples</label>
                <input type="file" name="multi_img[]" class="form-control" id="multiImg"
                    multiple="">
                <div class="row" id="preview_img"> </div>
            </div>
        </div><!-- Col -->

    </div><!-- Row -->

    {{-- Row 2 --}}
    <div class="row">

        {{-- BedRooms --}}
        <div class="col-sm-3">
            <div class="mb-3">
                <label class="form-label">Dormitorios</label>
                <input type="text" name="bedrooms" class="form-control">
            </div>
        </div><!-- Col -->

        {{-- Bathrooms --}}
        <div class="col-sm-3">
            <div class="mb-3">
                <label class="form-label">Baños</label>
                <input type="text" name="bathrooms" class="form-control">
            </div>
        </div><!-- Col -->

        {{-- Garage --}}
        <div class="col-sm-3">
            <div class="mb-3">
                <label class="form-label">Cochera</label>
                <input type="text" name="garage" class="form-control">
            </div>
        </div><!-- Col -->

        {{-- Garage Size --}}
        <div class="col-sm-3">
            <div class="mb-3">
                <label class="form-label">Tamaño de Cochera</label>
                <input type="text" name="garage_size" class="form-control">
            </div>
        </div><!-- Col -->

    </div><!-- Row -->

    {{-- Row 3 --}}
    <div class="row">

        {{-- Address --}}
        <div class="col-sm-3">
            <div class="mb-3">
                <label class="form-label">Dirección</label>
                <input type="text" name="address" class="form-control">
            </div>
        </div><!-- Col -->

        {{-- City --}}
        <div class="col-sm-3">
            <div class="mb-3">
                <label class="form-label">Ciudad</label>
                <input type="text" name="city" class="form-control">
            </div>
        </div><!-- Col -->

        {{-- State --}}
        <div class="col-sm-3">
            <div class="mb-3">
                <label class="form-label">Estado</label>
                <input type="text" name="state" class="form-control">
            </div>
        </div><!-- Col -->

        {{-- Postal Code --}}
        <div class="col-sm-3">
            <div class="mb-3">
                <label class="form-label">Código Postal</label>
                <input type="text" name="postal_code" class="form-control">
            </div>
        </div><!-- Col -->

    </div><!-- Row -->

    {{-- Row 4 --}}
    <div class="row">

        {{-- Property Size --}}
        <div class="col-sm-4">
            <div class="mb-3">
                <label class="form-label">Tamaño Propiedad</label>
                <input type="text" name="property_size"  class="form-control" >
            </div>
        </div><!-- Col -->

        {{-- Property Video --}}
        <div class="col-sm-4">
            <div class="mb-3">
                <label class="form-label">Video Propiedad</label>
                <input type="text" name="property_video"  class="form-control" >
            </div>
        </div><!-- Col -->

        {{-- Neighborhood --}}
        <div class="col-sm-4">
            <div class="mb-3">
                <label class="form-label">Vecindario</label>
                    <input type="text" name="neighborhood"  class="form-control" >
            </div>
        </div><!-- Col -->

    </div><!-- Row -->

    {{-- Row 5 --}}
    <div class="row">

        {{-- Latitude --}}
        <div class="col-sm-6">
            <div class="mb-3">
                <label class="form-label">Latitude</label>
                <input type="text" name="latitude" class="form-control">
                <a href="https://www.latlong.net/convert-address-to-lat-long.html" target="_blank">Go here to get Latitude
                    from address</a>
            </div>
        </div><!-- Col -->

        {{-- Longitude --}}
        <div class="col-sm-6">
            <div class="mb-3">
                <label class="form-label">Longitude</label>
                <input type="text" name="longitude" class="form-control">
                <a href="https://www.latlong.net/convert-address-to-lat-long.html" target="_blank">Go here to get Longitude
                    from address</a>
            </div>
        </div><!-- Col -->

    </div><!-- Row -->

    {{-- Row 6 --}}
    <div class="row">

        {{-- Property Type --}}
        <div class="col-sm-4">
            <div class="mb-3">
                <label class="form-label">Property Type</label>
                <input type="text" name="property_size" class="form-control">
            </div>
        </div><!-- Col -->

        {{-- Property Amenities --}}
        <div class="col-sm-4">
            <div class="mb-3">
                <label class="form-label">Property Amenities</label>
                <input type="text" name="property_video" class="form-control">
            </div>
        </div><!-- Col -->

        {{-- Agent --}}
        <div class="col-sm-4">
            <div class="mb-3">
                <label class="form-label">Agent</label>
                <input type="text" name="neighborhood" class="form-control">
            </div>
        </div><!-- Col -->

    </div><!-- Row -->

</form> 
```
Dejamos par ala siguiente lección el {{-- Row 6 --}}
Ya que estos campos los tenemos que relacionar con nuestras otras tablas.
Listo!
# 58. Add Property Database and Page Design Part 6
Relacionar la tabla de "property_types", "amenities", y de la tabla "users" vamos a relacionar al agente donde su 'role' sea un "agent" y que este "activo" (en campo 'status'), pasando los datos desde el controlador app/Http/Controllers/Backend/PropertyController.php
```php
// Añadir Propiedad
public function AddProperty(){

    $propertytype = PropertyType::latest()->get();
    $amenities = Amenities::latest()->get();
    $activeAgent = User::where('status','active')->where('role','agent')->latest()->get();

    return view('backend.property.add_property',compact('propertytype','amenities','activeAgent'));
} 
```
Para la seleccion de Tipo de Propiedad y Agente lo podemos resolver con una seleccion single:
en resources/views/backend/property/add_property.blade.php
```php
{{-- Row 6, Tipo de Propiedad, Comodidades, Agente --}}
<div class="row">

    {{-- Property Type --}}
    <div class="col-sm-4">
        <div class="mb-3">
            <label class="form-label">Tipo de Propiedad</label>
            <select name="ptype_id" class="form-select" id="exampleFormControlSelect1">
                <option selected="" disabled="">Seleccionar Tipo</option>
                @foreach($propertytype as $ptype)
                    <option value="{{ $ptype->id }}">{{ $ptype->type_name }}</option>
                @endforeach
            </select>
        </div>
    </div><!-- Col -->


    {{-- Agent --}}
    <div class="col-sm-4">
        <div class="mb-3">
            <label class="form-label">Agente</label>
            <select name="agent_id" class="form-select" id="exampleFormControlSelect1">
                <option selected="" disabled="">Seleccionar Agente</option>
                @foreach($activeAgent as $agent)
                    <option value="{{ $agent->id }}">{{ $agent->name }}</option>
                @endforeach
            </select>
        </div>
    </div><!-- Col -->

</div><!-- Row --> 
```
Para la seleccion de Comodidades lo podemos resolver con una seleccion multiple:
en resources/views/backend/property/add_property.blade.php
La estructura la podemos sacar de matreial de ejercicio en:
~/Sites/recursos/udemy/Laravel 10 - Build Real Estate Property Listing Project A-Z/Course+Excise+Files/Course Excise Files/Backend Theme/Main/pages/forms/advanced-elements.html 
usando "Multiple select using select 2"
Tenemos ue cargar el css y js especifico para este tipo de Multiple Select
```php
{{-- Property Amenities --}}
<div class="col-sm-4">
    <label class="form-label">Comodidades</label>
    <select name="amenities_id[]" class="js-example-basic-multiple form-select" multiple="multiple" data-width="100%">
        @foreach($amenities as $ameni)
            <option value="{{ $ameni->id }}">{{ $ameni->amenities_name }}</option>
        @endforeach
    </select>
</div><!-- Col -->
```
Y para soportar la seleccion multiple en resources/views/admin/admin_dashboard.blade.php:
```php
...
{{-- Plugins para la "Multiple select using select 2" que usamos en Property Amenities en resources/views/backend/property/add_property.blade.php --}}
<link rel="stylesheet" href="{{ asset('backend/assets/vendors/select2/select2.min.css') }}">
<link rel="stylesheet" href="{{ asset('backend/assets/vendors/jquery-tags-input/jquery.tagsinput.min.css') }}"> 
...
Y antes de que cierre el Body tag colocamos el codigo JS
{{-- Plugins para la "Multiple select using select 2" que usamos en Property Amenities en resources/views/backend/property/add_property.blade.php --}}
{{-- input tags --}}
<script src="{{ asset('backend/assets/vendors/inputmask/jquery.inputmask.min.js') }}"></script>
<script src="{{ asset('backend/assets/vendors/select2/select2.min.js') }}"></script>
<script src="{{ asset('backend/assets/vendors/typeahead.js/typeahead.bundle.min.js') }}"></script>
<script src="{{ asset('backend/assets/vendors/jquery-tags-input/jquery.tagsinput.min.js') }}"></script>
<script src="{{ asset('backend/assets/js/inputmask.js') }}"></script>
<script src="{{ asset('backend/assets/js/select2.js') }}"></script>
<script src="{{ asset('backend/assets/js/typeahead.js') }}"></script>
<script src="{{ asset('backend/assets/js/tags-input.js') }}"></script>
```
Listo!
# 59. Add Property Database and Page Design Part 7
Buscar una text area input para nuestros campos descripcion corta y larga.
Los drivers para tener un editor en el text area.
Para el txt area del long description:
~/Sites/recursos/udemy/Laravel 10 - Build Real Estate Property Listing Project A-Z/Course+Excise+Files/Course Excise Files/Backend Theme/Main/pages/forms/editors.html
En resources/views/backend/property/add_property.blade.php
```php
{{-- Short Description --}}
<div class="col-sm-12">
    <div class="mb-3">
        <label class="form-label">Descripción Corta</label>
        <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"></textarea>
    </div>
</div><!-- Col -->

{{-- Long Description --}}
<div class="col-sm-12">
    <div class="mb-3">
        <label class="form-label">Descripción Larga</label>
        <textarea class="form-control" name="tinymce" id="tinymceExample" rows="10"></textarea>
    </div>
</div><!-- Col --> 
```
Para soportar el tinymce hay que incluir en resources/views/admin/admin_dashboard.blade.php
```php
{{-- Plugins para soportar al editor tinymce que lo usamos en resources/views/backend/property/add_property.blade.php --}}
<script src="{{ asset('backend/assets/vendors/tinymce/tinymce.min.js') }}"></script>
<script src="{{ asset('backend/assets/js/tinymce.js') }}"></script>
```
Para los check boxes de Features Property y Hot Property insertamos en resources/views/backend/property/add_property.blade.php
```php
{{-- Checkboxes Features Property y Hot Property --}}
<div class="mb-3">

    <div class="form-check form-check-inline">
        <input type="checkbox" name="featured" value="1" class="form-check-input" id="checkInline1">
        <label class="form-check-label" for="checkInline1">
            Features Property
        </label>
    </div>

    <div class="form-check form-check-inline">
        <input type="checkbox" name="hot" value="1" class="form-check-input" id="checkInline">
        <label class="form-check-label" for="checkInline">
            Hot Property
        </label>
    </div>

</div> 
```
En name va el nombre del campo y en value va el valor que inertaremos en el campo si lo dejaron en check!
Listo!
# 60. Add Property Database and Page Design Part 8
Agregar las Instalaciones Cercas en resources/views/backend/property/add_property.blade.php
```php
...
{{-- Facilities Option --}}
<div class="row add_item">

    {{-- Instalaciones Cercanas --}}
    <div class="col-md-4">
        <div class="mb-3">
            <label for="facility_name" class="form-label">Instalaciones Cercanas</label>
            <select name="facility_name[]" id="facility_name" class="form-control">
                <option value="">Selecciona Instalación</option>
                <option value="Hospital">Hospital</option>
                <option value="Super Mercado">Super Mercado</option>
                <option value="Escuela">Escuela</option>
                <option value="Entretenimiento">Entretenimiento</option>
                <option value="Farmacia">Farmacia</option>
                <option value="Aeropuerto">Aeropuerto</option>
                <option value="Estación de Tren">Estación de Tren</option>
                <option value="Parada de autobus">Parada de autobus</option>
                <option value="Playa">Playa</option>
                <option value="Centro Comercial">Centro Comercial</option>
                <option value="Banco">Banco</option>
                <option value="Cine">Cine</option>
                <option value="Restaurante">Restaurante</option>
            </select>
        </div>
    </div>

    {{-- Distance --}}
    <div class="col-md-4">
        <div class="mb-3">
            <label for="distance" class="form-label">Distancia</label>
            <input type="text" name="distance[]" id="distance" class="form-control" placeholder="Distancia en (Km)">
        </div>
    </div>

    {{-- Add More.. --}}
    <div class="form-group col-md-4" style="padding-top: 30px;">
        <a class="btn btn-success addeventmore"><i class="fa fa-plus-circle"></i>Agregar mas...</a>
    </div>

</div>
<!---end row--> 
...
<!--========== Start of add multiple class with ajax, Para agregar mas opciones a Facilities Option ==============-->
<div style="visibility: hidden">
    <div class="whole_extra_item_add" id="whole_extra_item_add">
        <div class="whole_extra_item_delete" id="whole_extra_item_delete">
            <div class="container mt-2">
                <div class="row">

                    <div class="form-group col-md-4">
                        <label for="facility_name">Facilities</label>
                        <select name="facility_name[]" id="facility_name" class="form-control">

                            <option value="">Selecciona Instalación</option>
                            <option value="Hospital">Hospital</option>
                            <option value="Super Mercado">Super Mercado</option>
                            <option value="Escuela">Escuela</option>
                            <option value="Entretenimiento">Entretenimiento</option>
                            <option value="Farmacia">Farmacia</option>
                            <option value="Aeropuerto">Aeropuerto</option>
                            <option value="Estación de Tren">Estación de Tren</option>
                            <option value="Parada de autobus">Parada de autobus</option>
                            <option value="Playa">Playa</option>
                            <option value="Centro Comercial">Centro Comercial</option>
                            <option value="Banco">Banco</option>
                            <option value="Cine">Cine</option>
                            <option value="Restaurante">Restaurante</option>

                        </select>
                    </div>
                    <div class="form-group col-md-4">
                        <label for="distance">Distancia</label>
                        <input type="text" name="distance[]" id="distance" class="form-control"
                            placeholder="Distancia en (Km)">
                    </div>
                    <div class="form-group col-md-4" style="padding-top: 20px">
                        <span class="btn btn-success btn-sm addeventmore"><i class="fa fa-plus-circle">Agregar</i></span>
                        <span class="btn btn-danger btn-sm removeeventmore"><i class="fa fa-minus-circle">Remover</i></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!----For Section-------->
<script type="text/javascript">
    $(document).ready(function(){
       var counter = 0;
       $(document).on("click",".addeventmore",function(){
             var whole_extra_item_add = $("#whole_extra_item_add").html();
             $(this).closest(".add_item").append(whole_extra_item_add);
             counter++;
       });
       $(document).on("click",".removeeventmore",function(event){
             $(this).closest("#whole_extra_item_delete").remove();
             counter -= 1
       });
    });
</script>
<!--========== End of add multiple class with ajax ==============-->
```
Con esto logramos poder poder agregar Instalciones cercas y todas las podremos grabar a la tabla, esto
se vera mas adelante.
Listo!
# 61. Add Property JavaScript Validation
Agragar validacion a nuestra forma!
En resources/views/backend/property/add_property.blade.php
- Empatar la forma con el id="myForm" que ya definimos en el codigo JS al final de la pagina
- No olvidar usar el "form-group" par alos campos que queremos validar
```php
...
{{-- Nombre Propiedad --}}
<div class="col-sm-6">
    <div class="form-group mb-3">
        <label class="form-label">Nombre</label>
        <input type="text" name="property_name" class="form-control">
    </div>
</div><!-- Col -->

{{-- Property Status --}}
<div class="col-sm-6">
    <div class="form-group mb-3">
        <label class="form-label">Estatus</label>
        <select name="property_status" class="form-select"
            id="exampleFormControlSelect1">
            <option selected="" disabled="">Seleccionar Estatus</option>
            <option value="rent">Para Renta</option>
            <option value="buy">Para Compra</option>
        </select>
    </div>
</div><!-- Col -->

{{-- Lowest Price --}}
<div class="col-sm-6">
    <div class="form-group mb-3">
        <label class="form-label">Precio mas Bajo</label>
        <input type="text" name="lowest_price" class="form-control">
    </div>
</div><!-- Col -->

{{-- Max Price --}}
<div class="col-sm-6">
    <div class="form-group mb-3">
        <label class="form-label">Precio mas Alto</label>
        <input type="text" name="max_price" class="form-control">
    </div>
</div><!-- Col --> 
...
{{-- Property Type --}}
<div class="col-sm-4">
    <div class="form-group mb-3">
        <label class="form-label">Tipo de Propiedad</label>
        <select name="ptype_id" class="form-select" id="exampleFormControlSelect1">
            <option selected="" disabled="">Seleccionar Tipo</option>
            @foreach($propertytype as $ptype)
                <option value="{{ $ptype->id }}">{{ $ptype->type_name }}</option>
            @endforeach
        </select>
    </div>
</div><!-- Col -->
...
{{-- Script de JS para la Validación --}}
<script type="text/javascript">
    $(document).ready(function (){
        $('#myForm').validate({

            rules: {
                property_name: {
                    required : true,
                },
                property_status: {
                    required : true,
                },
                lowest_price: {
                    required : true,
                },
                max_price: {
                    required : true,
                },
                ptype_id: {
                    required : true,
                },

            },

            messages :{

                property_name: {
                    required : 'Favor entrar nombre de la Propiedad, campo requerido',
                },
                property_status: {
                    required : 'Favor seleccionar Estatus de la Propiedad, campo requerido',
                },
                lowest_price: {
                    required : 'Favor entrar precio mas bajo, campo requerido',
                },
                max_price: {
                    required : 'Favor entrar precio mas alto, campo requerido',
                },
                ptype_id: {
                    required : 'Favor seleccionar Tipo de Propiedad, campo requerido',
                },

            },

            errorElement : 'span',
            errorPlacement: function (error,element) {
                error.addClass('invalid-feedback');
                element.closest('.form-group').append(error);
            },
            highlight : function(element, errorClass, validClass){
                $(element).addClass('is-invalid');
            },
            unhighlight : function(element, errorClass, validClass){
                $(element).removeClass('is-invalid');
            },
        });
    });

</script>
```
Listo!

# Sección 10 - Backend Insert Property Setup 
# 62. Install Image Intervention Package
Utilizar el paquete de Laravel Intervention Packeage para reizes las imagenes que vamos a subir!
https://image.intervention.io/v2
Intervention Image is an open source PHP image handling and manipulation library. It provides an easier and expressive way to create, edit, and compose images and supports currently the two most common image processing libraries GD Library and Imagick.
Instalar el paquete:
```php
composer require intervention/image 
```
After you have installed Intervention Image, open your Laravel config file config/app.php and add the following lines.
In the $providers array add the service providers for this package.
En config/app.php, en Autoloaded Service Providers - Package Service Providers, agregar:
```php
/*
* Package Service Providers...
*/
Intervention\Image\ImageServiceProvider::class,
```
Add the facade of this package to the $aliases array, en la seccion de Class Aliases.
```php
'aliases' => Facade::defaultAliases()->merge([
    // 'Example' => App\Facades\Example::class,
    'Image' => Intervention\Image\Facades\Image::class
])->toArray(),
```
By default Intervention Image uses PHP's GD library extension to process all images. If you want to switch to Imagick, you can pull a configuration file into your application by running one of the following artisan command.
Publish configuration in Laravel
```php
php artisan vendor:publish --provider="Intervention\Image\ImageServiceProviderLaravelRecent"
```
Copying file [vendor/intervention/image/src/config/config.php] to [config/image.php] ........................................................ DONE
Listo!
# 63. Property Insert Database Part 1





# 64. Property Insert Database Part 2
# 65. Property Insert Database Part 3
# 66. Property Insert Database Part 4
# 67. Manage Property Read All Product
# 68. Manage Property Edit Option Part 1
# 69. Manage Property Edit Option Part 2
# 70. Manage Property Update Option
# 71. Manage Property Update Single and Multiple Image Part 1
# 72. Manage Property Update Single and Multiple Image Part 2
# 73. Manage Property Update Single and Multiple Image Part 3
# 74. Manage Property Update Single and Multiple Image Part 4
# 75. Multiple Image Delete
# 76. Add Multi Image In Property
# 77. Manage Property Update Facility Part 1
# 78. Manage Property Update Facility Part 2
# 79. Property Delete With Multiple Image
# 80. Create Property Details Page Part 1
# 81. Create Property Details Page Part 2
# 82. Property Active Inactive From Details Page
# 83. Bug Fixed for Redirect Login Page






